# ロボット×ベイズ 実行時メモ

起動順と最低限の確認事項など。詳しい仕様は各READMEや他ドキュメントに記載。

## 1. メインRaspiの事前チェック

いつも通りメインRaspiにSSHで接続してコードを開き、マイクとサーモホンチェック。
`startcarbat.go` を実行して、動作確認。  
その際には、`robot_pc_connection_test.py`を実行しておく。  
（時間サーバーを立てておくため。それ以外ではこのコードは使わない。）

## 2. 足元用Raspiのセットアップ

メインRaspiから足元用RaspiへSSH接続する。

`motor_code/README.md` を見ながらモーターのパラメータ調整を行う。デフォルト値は `--dis-scale=1` と `--turn-scale=1`。

前進の調整:
```
python3 roboclaw_test.py --mode distance --dis-scale <前進スケール>
```

旋回の調整:
```
python3 roboclaw_test.py --mode angle --turn-scale <回転スケール>
```

パラメータが決まったら、受信サーバーを起動したままにしておく:
```
python3 udp_roboclaw_server.py --dis-scale <決定値> --turn-scale <決定値>
```

これでメインRaspiからの移動距離、回転、パルス放射方向の指令を受け取れる。

## 3. モーションキャプチャの準備（Motive）

マーカーを配置していく。ヘッド（サーモホン）に3点、ボディに3点以上。障害物用のマーカーも事前に配置しておく。

Motiveでリジッドボディの名前を設定: `robot_head`, `robot_body`, `obstacles`。ただし大量の障害物での動作はまだ未検証。

## 4. MoCapリアルタイム取得の確認

`Lab_Bayesian/marker_server.py` を実行する。デフォルトでは本番モードの配信サーバーとして動作するけど、必要なら `--mode test` でダミー確認もできる。本番時はこれを起動したままにしておく。

別ターミナルで `Lab_Bayesian/marker_test.py` を実行して、リアルタイムでデータが取れてるか確認。詳細なオプションやデータ仕様は `Lab_Bayesian/marker.md` 参照。

## 5. ベイズ初期化と本番起動

本番で `startcarbat.go` を走らせる前に、PC側で `Lab_Bayesian/control_pc.py` を起動しておく必要がある:

```
python control_pc.py
```

これはモーションキャプチャからのリアルタイム位置を受け取ってベイズの初期化を行うやつ。`startcarbat.go` から呼び出される前提なので、必ず先に起動する。

その後、メインRaspiで `startcarbat.go` を本番実行する。
(`Lab_Bayesian/robot_simulation`はロボットが手元にない際の検証用コード)
