# -*- coding: utf-8 -*-
"""
Configuration File for Bat Echolocation Simulation
====================================
このファイルはシミュレーション全体で使用されるパラメータを一元管理します。

パラメータの分類:
- 物理パラメータ: 音波、コウモリの身体的特徴など
- 時間パラメータ: エコー時間軸の設定
- 空間パラメータ: シミュレーション空間の設定
- 検出パラメータ: エコー検知の閾値とノイズ
- シミュレーションパラメータ: 試行回数、初期位置など
- ベイズ推論パラメータ: ベイズ更新のパラメータ
- フォルダ設定: データ保存先
"""

import numpy as np

# ========================================
# 物理パラメータ
# ========================================
h = 0.01              # 格子点間隔 [m]
freq = 40000          # 周波数 [Hz] - コウモリが発する超音波の周波数
c = 340               # 音速 [m/s]
a = 0.005             # 口の半径サイズ [m] - 超音波を発する口の大きさ
ear_dist = 0.02       # 耳間距離 [m] - コウモリの左右の耳の間の距離

# ========================================
# 時間パラメータ
# ========================================
dt = 100 * 10**-6     # エコー時間刻み幅 [s]
t_max = 64 * 10**-3   # エコー最大時間レンジ [s]
Mt = int(np.round(t_max / dt))           # 時間刻み数
t_ax = np.linspace(0, t_max, Mt + 1)     # 時間軸の生成

# ========================================
# 空間パラメータ
# ========================================
x_max = 8.5           # シミュレーション空間の最大x座標 [m]
y_max = 8.5           # シミュレーション空間の最大y座標 [m]
margin_space = 2      # 境界マージン空間 [m]
Mx = My = int(np.round(y_max / h))       # 空間格子点数

# ========================================
# 検出パラメータ
# ========================================
threshold = 1.2 * 0.1**3  # エコー検知最小感度（さらに、conf1の半値境目）
grad = 10**15             # conf1の勾配
k_r_noise = 60000         # 距離ノイズ係数
k_theta_noise = 360000    # 角度ノイズ係数

# ========================================
# シミュレーションパラメータ
# ========================================
trials = 20           # 試行回数

# 初期位置パラメータ [x, y, fd, pd]
# x, y: 初期座標 [m]
# fd: 飛行方向（度数法）
# pd: パルス発射方向（度数法）
init_pos = [2.5, 6.05, 270, 270]

# ========================================
# ベイズ推論パラメータ
# ========================================
sigma2 = (0.0001 * c) ** 2  # ベイズ更新の分散パラメータ
min_p = -320                # 最小確率値（対数スケール）

# ========================================
# 可視化パラメータ
# ========================================
c_percentile = 95     # カラーマップのパーセンタイル

# ========================================
# フォルダ設定
# ========================================
folder_name = "bayse_olddata2"  # データ保存フォルダ
output_dir_movie = folder_name + "/movie/sim2"  # 動画出力ディレクトリ

# ========================================
# フラグ設定
# ========================================
# 障害物を壁の線上に配置するかどうか
world_pole_wall = False

# 壁の外を認知-20にするかどうか
world_wall_pos = True
